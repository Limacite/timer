<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="elm.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
    <script src="cercle.js"></script>
    <title>Port Example</title>
</head>

<body>
    <div id="root"></div>
    <div id="chart-position">
    <div id="chart-container" style="pisition: relative; height: 400px; width: 400px">
      <canvas id="myPieChart"></canvas>
    </div>
    </div>
    <script>
    //bell
      var app = Elm.Main.init({
        node: document.getElementById("root")
      });
      var bell = new Audio(`bell.mp3`);

      app.ports.beep.subscribe(
        function(){
          bell.play();
      });

      var timelist = [3000,2000,0];
      var inStart = false;
      var count = 0;
      var workingFlag = false;
      var timeKeeper = [0,3000,0,2000];
      var ctx = document.getElementById("myPieChart");
      var myPieChart = new Chart(ctx, {
        type: 'pie',
        data: {
          datasets: [{
              backgroundColor: [
                  "#DA70D6",
                  "#BB5179",
                  "#3C00FF",
                  "#6495ED"
              ],
              data: timeKeeper
          }]
        },
        options: {
          animation : {
            duration:0
          },
          responsive: true,
          cutoutPercentage: 90
        }
      });

      app.ports.timeSet.subscribe(function(message){
         //message : [limit,interval,counter]
        timelist = message.map(x => x * 1000);
        count = timelist[2];
        timeKeeper = [0,timelist[0],0,timelist[1]]
        myPieChart.update();
      });

      app.ports.doSet.subscribe(function(doSwitch){
        inStart = !doSwitch;
      })

      setInterval(function(){if(inStart){updateChart();}},1);
    </script>
    <style type="text/css">
      #timer{
      }
      #chart-position{
        position: absolute;
        top: 65px;
        left: 50%;
        z-index: -1;
        transform: translate(-50%, -5%);
      }
      #chart-container{
        margin: auto;
      }
      #myPieChart{
        position: relative;
        left: 50%;
        transform: translate(-50%,40%);
      }
    </style>
</body>

</html>
